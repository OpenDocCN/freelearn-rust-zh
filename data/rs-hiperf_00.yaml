- en: Preface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: Welcome to *Rust High Performance*. In this book, you will get a gentle introduction
    to high-performance programming by learning how to improve the performance of
    your Rust code. It will show you how to translate your code from other languages
    properly by avoiding common bottlenecks, and it will show you how to easily increase
    the performance of your application using some idiomatic Rust APIs.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎来到《Rust高性能编程》。在这本书中，你将通过学习如何提高你的Rust代码性能来获得对高性能编程的温和介绍。它将向你展示如何通过避免常见瓶颈正确地将代码从其他语言转换过来，以及如何使用一些惯用的Rust
    API轻松提高你应用程序的性能。
- en: You will learn about the great Rust community by finding great crates that will
    increase the development efficiency while also improving the performance of your
    application, and you will write examples to use all your knowledge. You will write
    your own macros and custom derives, and you will learn about asynchronous and
    multithreaded programming.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 通过找到能提高开发效率并改善你应用程序性能的优秀crate，你将了解伟大的Rust社区。你将编写示例来使用你所有的知识。你将编写自己的宏和自定义derives，并学习关于异步和多线程编程。
- en: Who this book is for
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书面向的对象
- en: In this book, you will find everything you need to improve the performance of
    your Rust code; you will learn many tricks and use helpful crates and tools. Therefore,
    the book is written from the basis that you already have some knowledge of programming
    in Rust.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，你将找到提高你的Rust代码性能所需的一切；你将学会许多技巧，并使用有用的crate和工具。因此，本书的编写基于你已经具备一些Rust编程知识的基础。
- en: This book will not cover the whole world of high-performance programming since
    it's an incredibly wide topic. You will find a gentle introduction to most of
    the generic high-performance programming concepts and learn how specific patterns
    can be used in the Rust programming language.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本书不会涵盖高性能编程的整个世界，因为这是一个极其广泛的话题。你将找到对大多数通用高性能编程概念的温和介绍，并学习如何在Rust编程语言中使用特定的模式。
- en: What this book covers
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书涵盖的内容
- en: '[Chapter 1](ad672e4d-0f5e-4c59-b823-249da183abc8.xhtml), *Common Performance
    Pitfalls*, helps you learn why translating from languages such as C/C++ can lead
    to big performance decline, how to improve your algorithms using different Copy/Clone
    types and references, and understand how cyclomatic complexity can make compiler
    optimizations less effective.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[第一章](ad672e4d-0f5e-4c59-b823-249da183abc8.xhtml)，*常见的性能陷阱*，帮助你了解从C/C++等语言转换过来可能导致性能大幅下降的原因，如何使用不同的Copy/Clone类型和引用来改进你的算法，以及了解循环复杂度如何使编译器优化变得不那么有效。'
- en: '[Chapter 2](da2d0480-3314-408b-9cad-60987754f45d.xhtml), *Extra Performance
    Enhancements*, takes a step forward to understand some tips and tricks Rust gives
    us to improve the performance of your applications. After learning about common
    mistakes in the previous chapters, you will learn how to use the Rust type system
    to your advantage, creating complex compile-time checks and evaluations. You will
    also understand the difference between the common standard library collections
    so that you can choose the right one for your algorithm.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[第二章](da2d0480-3314-408b-9cad-60987754f45d.xhtml)，*额外的性能提升*，进一步探讨了Rust为我们提供的提高应用程序性能的一些技巧和窍门。在了解了前几章中常见的错误之后，你将学习如何利用Rust类型系统为你带来优势，创建复杂的编译时检查和评估。你还将了解常见标准库集合之间的区别，以便为你的算法选择正确的集合。'
- en: '[Chapter 3](71d38dd3-1f0b-408e-b454-3d342b413f7c.xhtml), *Memory Management
    in Rust*, shows you how to improve the memory footprint of your applications by
    taking advantage of the borrow checker. You will learn about lifetimes and how
    to properly use them, understand the different representation attributes that
    will help your data be properly structured in memory, and finally, learn how to
    create efficient shared pointer structures for your application using standard
    library types.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[第三章](71d38dd3-1f0b-408e-b454-3d342b413f7c.xhtml)，*Rust中的内存管理*，展示了如何通过利用借用检查器来提高你应用程序的内存占用。你将了解生命周期以及如何正确使用它们，理解有助于你的数据在内存中正确结构化的不同表示属性，最后，学习如何使用标准库类型为你的应用程序创建高效的共享指针结构。'
- en: '[Chapter 4](0a00a575-c592-4022-8721-79c2f2d63f76.xhtml), *Lints and Clippy*,
    teaches you the power of lints and how to configure them to give you proper suggestions.
    You''ll learn how to configure clippy, an incredibly powerful tool that will point
    out common errors and potential performance improvements. In this chapter, you
    will learn the most important clippy lints and use them in your development workflow.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '[第4章](0a00a575-c592-4022-8721-79c2f2d63f76.xhtml)，*代码检查与Clippy*，教你了解代码检查的强大功能以及如何配置它们以提供适当的建议。你将学习如何配置Clippy，这是一个功能强大的工具，能够指出常见的错误和潜在的性能改进。在本章中，你将了解最重要的Clippy代码检查，并在你的开发工作流程中使用它们。'
- en: '[Chapter 5](f8df2811-838d-40e2-970d-f50b909252f1.xhtml), *Profiling Your Rust
    Application*, covers how to use profiling software so that you can easily find
    performance bottlenecks in your applications. You''ll learn how cache misses impact
    your code and how to find where in the code is the application spending more time.
    You will learn to fix those bottlenecks and therefore improve the overall performance
    of the application.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[第5章](f8df2811-838d-40e2-970d-f50b909252f1.xhtml)，*分析你的Rust应用程序*，介绍了如何使用分析软件，以便你可以轻松地找到应用程序中的性能瓶颈。你将了解缓存未命中如何影响你的代码，以及如何在代码中找到应用程序花费更多时间的地方。你将学会修复这些瓶颈，从而提高应用程序的整体性能。'
- en: '[Chapter 6](4a4cf14d-1c2e-4a33-9856-6ef520591a44.xhtml), *Benchmarking*, discusses
    how to detect performance critical code and how to benchmark it in both Rust stable
    and nightly. You will also learn how to set up your continuous integration environment
    to get performance reports and track them during the development process of your
    project.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[第6章](4a4cf14d-1c2e-4a33-9856-6ef520591a44.xhtml)，*基准测试*，讨论了如何检测性能关键代码以及如何在Rust稳定版和夜间版中对其进行基准测试。你还将学习如何设置你的持续集成环境以获取性能报告，并在你的项目开发过程中跟踪它们。'
- en: '[Chapter 7](addcacb4-e419-472d-a85f-6fc1df656a4f.xhtml), *Built-in Macros and
    Configuration Items*, brings you to the world of attributes that can personalize
    your code so that you target specific platforms with each section of your code
    using all of each platform''s potential. You will understand how to divide your
    crate so that not all the code has to be compiled for each use, and you will finally
    learn how to use nightly features to improve the efficiency of your code and the
    amount of code to write.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[第7章](addcacb4-e419-472d-a85f-6fc1df656a4f.xhtml)，*内置宏和配置项*，带你进入可以个性化你的代码的属性的世界，这样你可以使用代码的每一部分针对特定的平台，利用每个平台的所有潜力。你将了解如何划分你的库，以便不是所有的代码都必须为每个用途编译，你最终将学习如何使用夜间功能来提高你代码的效率和需要编写的代码量。'
- en: '[Chapter 8](df987844-92ff-407c-8912-a6a5a2202939.xhtml), *Must-Have Macro Crates*,
    introduces you to multiple metaprogramming crates—create serializable structures,
    deserialize data from languages such as JSON or TOML, parse log files, or create
    a lot of boilerplate code for your data structures. Here, you can understand how
    to initialize complex static structures and use a proper error handling. Finally,
    thanks to nightly Rust and plugins, you will be able to create a small web server
    with a database and even attach to it the fastest template system in existence.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[第8章](df987844-92ff-407c-8912-a6a5a2202939.xhtml)，*必备宏库*，介绍了多个元编程库——创建可序列化的结构，从JSON或TOML等语言中反序列化数据，解析日志文件，或者为你的数据结构创建大量的代码模板。在这里，你可以了解如何初始化复杂的静态结构，并使用适当的错误处理。最后，得益于夜间Rust和插件，你将能够创建一个带有数据库的小型Web服务器，甚至可以连接到它存在的最快的模板系统。'
- en: '[Chapter 9](e869a4d7-e2a8-488a-a767-8c75364a8962.xhtml), *Creating Your Own
    Macros*, covers how to write your own macros to avoid code boilerplate. You will
    understand how the new macros 1.1 work and create your first custom derive. Finally,
    you will learn how compiler plugins internally work and will create your own compiler
    plugin.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[第9章](e869a4d7-e2a8-488a-a767-8c75364a8962.xhtml)，*创建自己的宏*，介绍了如何编写自己的宏以避免代码冗余。你将了解新的宏1.1版本的工作原理，并创建你的第一个自定义派生。最后，你将学习编译器插件是如何在内部工作的，并将创建你自己的编译器插件。'
- en: '[Chapter 10](03028198-9025-4bfd-8677-215147e9400d.xhtml), *Multithreading*,
    outlines how to create multiple threads to balance the work of your application.
    You will understand the full power of Rust''s threads and the synchronization
    primitives in the standard library. In addition, you will learn how to send information
    between threads. Finally, you will read about some useful crates that will enable
    you to implement work stealing algorithms, parallel iterators, and more.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[第10章](03028198-9025-4bfd-8677-215147e9400d.xhtml)，*多线程*，概述了如何创建多个线程以平衡应用程序的工作。您将了解Rust线程的全部功能和标准库中的同步原语。此外，您还将学习如何在线程之间发送信息。最后，您将了解一些有用的crate，这些crate可以帮助您实现工作窃取算法、并行迭代器等。'
- en: '[Chapter 11](1f89e376-87c6-450b-ad9e-a7727a6cb408.xhtml), *Asynchronous Programming*,
    helps you understand how asynchronous programming works. Here, you can learn how
    to develop asynchronous algorithms in Rust, thanks to mio and futures, and learn
    the new async/await syntax. You can also create asynchronous applications using
    tokio and WebSockets.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '[第11章](1f89e376-87c6-450b-ad9e-a7727a6cb408.xhtml)，*异步编程*，帮助您了解异步编程是如何工作的。在这里，您可以通过mio和futures学习如何在Rust中开发异步算法，并学习新的async/await语法。您还可以使用tokio和WebSockets创建异步应用程序。'
- en: To get the most out of this book
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 要充分利用本书
- en: This book assumes some basic knowledge of the Rust programming language. If
    you are new to Rust, the first few chapters of the official Rust book are a great
    prelude. Nevertheless, you should have moderate to deep knowledge of at least
    one programming language; basic knowledge of terminal usage will also be needed.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本书假设您对Rust编程语言有一些基本了解。如果您是Rust的新手，官方Rust书籍的前几章是一个很好的序言。尽管如此，您应该至少对一种编程语言有适度的或深入的了解；还需要具备终端使用的基本知识。
- en: Having basic knowledge of computer architectures is a plus, along with basic
    knowledge of high-performance programming in C/C++. They are not required, though,
    since in this book we will cover all the base theory to understand how the performance
    improvements work behind the scenes.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 具备计算机架构的基本知识以及C/C++高性能编程的基本知识将是一个加分项，尽管它们不是必需的，因为在这本书中，我们将涵盖所有基础理论，以了解幕后性能改进的工作原理。
- en: You will need a code editor or an IDE to follow the book. Rust has been heavily
    tested in Microsoft's Visual Studio Code, GitHub's Atom, and IntelliJ's IDEA IDE.
    I have personally used Atom to write the code examples, but feel free to use your
    favorite text editor or IDE. You will probably find plugins or extensions for
    your editor.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要代码编辑器或IDE来遵循本书。Rust已经在Microsoft的Visual Studio Code、GitHub的Atom和IntelliJ的IDEA
    IDE中进行了大量测试。我个人使用Atom编写代码示例，但请随意使用您喜欢的文本编辑器或IDE。您可能会在您的编辑器中找到插件或扩展。
- en: In the case of VS Code, Atom, and IntelliJ IDEA, you will find official Rust
    packages along with unofficial extensions. Personally, I've been using the Tokamak
    package for Atom.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在VS Code、Atom和IntelliJ IDEA的情况下，您将找到官方的Rust包以及非官方的扩展。我个人一直在使用Atom的Tokamak包。
- en: Download the example code files
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载示例代码文件
- en: You can download the example code files for this book from your account at [www.packtpub.com](http://www.packtpub.com).
    If you purchased this book elsewhere, you can visit [www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files emailed directly to you.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从[www.packtpub.com](http://www.packtpub.com)的账户下载本书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。
- en: 'You can download the code files by following these steps:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过以下步骤下载代码文件：
- en: Log in or register at [www.packtpub.com](http://www.packtpub.com/support).
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[www.packtpub.com](http://www.packtpub.com/support)登录或注册。
- en: Select the SUPPORT tab.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择支持选项卡。
- en: Click on Code Downloads & Errata.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代码下载与勘误。
- en: Enter the name of the book in the Search box and follow the onscreen instructions.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索框中输入书籍名称，并遵循屏幕上的说明。
- en: 'Once the file is downloaded, please make sure that you unzip or extract the
    folder using the latest version of:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 文件下载完成后，请确保使用最新版本的以下软件解压缩或提取文件夹：
- en: WinRAR/7-Zip for Windows
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WinRAR/7-Zip for Windows
- en: Zipeg/iZip/UnRarX for Mac
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zipeg/iZip/UnRarX for Mac
- en: 7-Zip/PeaZip for Linux
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 7-Zip/PeaZip for Linux
- en: The code bundle for the book is also hosted on GitHub at [https://github.com/PacktPublishing/Rust-High-Performance](https://github.com/PacktPublishing/Rust-High-Performance). In
    case there's an update to the code, it will be updated on the existing GitHub
    repository.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 书籍的代码包也托管在GitHub上，网址为 [https://github.com/PacktPublishing/Rust-High-Performance](https://github.com/PacktPublishing/Rust-High-Performance)。如果代码有更新，它将在现有的GitHub仓库中更新。
- en: We also have other code bundles from our rich catalog of books and videos available
    at **[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)**.
    Check them out!
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有其他来自我们丰富的书籍和视频目录的代码包，可在 **[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)**
    上找到。查看它们吧！
- en: Conventions used
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用的约定
- en: There are a number of text conventions used throughout this book.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 本书使用了多种文本约定。
- en: '`CodeInText`: Indicates code words in text, database table names, folder names,
    filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles.
    Here is an example: "The iterator will not run until you call `collect()` method
    or use it in a loop. Those are the moments in which the `next()` method gets executed."'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟URL、用户输入和Twitter昵称。以下是一个示例：“迭代器将在您调用`collect()`方法或将其用于循环之前不会运行。这些就是在`next()`方法执行的时刻。”'
- en: 'A block of code is set as follows:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 代码块设置如下：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Any command-line input or output is written as follows:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 任何命令行输入或输出都应如下所示：
- en: '[PRE1]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Bold**: Indicates a new term, an important word, or words that you see onscreen.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。'
- en: Warnings or important notes appear like this.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 警告或重要说明看起来是这样的。
- en: Tips and tricks appear like this.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 小技巧和技巧看起来是这样的。
- en: Get in touch
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 联系我们
- en: Feedback from our readers is always welcome.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我们欢迎读者的反馈。
- en: '**General feedback**: Email `feedback@packtpub.com` and mention the book title
    in the subject of your message. If you have questions about any aspect of this
    book, please email us at `questions@packtpub.com`.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '**一般反馈**：请通过 `feedback@packtpub.com` 发送电子邮件，并在邮件主题中提及书籍标题。如果您对本书的任何方面有疑问，请通过
    `questions@packtpub.com` 发送电子邮件给我们。'
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata),
    selecting your book, clicking on the Errata Submission Form link, and entering
    the details.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '**勘误**: 尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问 [www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。'
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the Internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at `copyright@packtpub.com` with a
    link to the material.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**盗版**: 如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过 `copyright@packtpub.com`
    联系我们，并附上材料的链接。'
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com/).'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com/)。'
- en: Reviews
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评论
- en: Please leave a review. Once you have read and used this book, why not leave
    a review on the site that you purchased it from? Potential readers can then see
    and use your unbiased opinion to make purchase decisions, we at Packt can understand
    what you think about our products, and our authors can see your feedback on their
    book. Thank you!
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 请留下评论。一旦您阅读并使用了这本书，为什么不在您购买它的网站上留下评论呢？潜在读者可以查看并使用您的客观意见来做出购买决定，Packt公司可以了解您对我们产品的看法，我们的作者也可以看到他们对书籍的反馈。谢谢！
- en: For more information about Packt, please visit [packtpub.com](https://www.packtpub.com/).
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 想了解更多关于Packt的信息，请访问 [packtpub.com](https://www.packtpub.com/)。
