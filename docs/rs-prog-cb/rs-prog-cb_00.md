# 前言

几年前，我像许多程序员一样，每年开始学习一门新的编程语言。了解另一种编程语言可以从中获得许多范式、规则和见解，然后我发现了 Rust。Rust 真的很有趣，以至于我无法仅仅为了继续前进而放弃它。在学习曲线陡峭之后，它变得更加有趣。所以，就这样了：学习了总共两种额外的（TypeScript 和 Rust）语言后，我坚持学习 Rust。为什么？让我们来看看。

Rust 是一种系统编程语言，它通过默认的垃圾回收器提供内存安全，这影响了其运行时行为。尽管如此，Rust 是一种非常灵活的语言，可以应用于各种领域，无论是网页编程、游戏引擎还是网页客户端。此外，它挑战了关于作用域和内存分配的传统思维，使你在任何语言（无论是 C#、Java 还是 Python）中都能成为更好的程序员。亚马逊、微软和谷歌等公司最新的推动力表明，生态系统已经发展到足够稳定，足以用于企业级应用——这对未来的 Rust 专业人士来说是一个好兆头。

在本书中，我们收集了最有用的实验和合理的用例，以帮助您快速提高生产力。我们试图涵盖广泛的应用，希望您能找到有用的概念以及可以直接应用于您日常开发工作的解决方案。

# 本书面向的对象

这本书不是一本典型的学习编程语言的书籍。我们不想深入探讨概念，而是想展示一系列可能的项目、解决方案和应用，这些可以提供进一步链接到概念和其他资源。因此，我们认为这本书适合任何希望快速进入实际应用的人——无论他们的 Rust 经验如何。然而，编程基础（在任何语言中）是必需的——它们是您的 Rust 技能的基础。

# 本书涵盖的内容

第一章，*从 Rust 开始*，介绍了如何在您的计算机上设置 Rust 工具链以及语言的根本结构。这些包括编写测试和基准测试，以及循环、`if` 表达式、特性和结构体等语言结构。

第二章，*深入 Rust 进阶*，回答了关于语言更深入特性的问题以及创建有意义的程序的模式。主题包括复杂场景中的借用和所有权、`Option` 类型、模式匹配、泛型和显式生命周期以及枚举。

第三章，*使用 Cargo 管理项目*，使用 `cargo` 工具来管理额外的 crate、扩展、项目和测试。您将找到能够让您在更大的项目中工作并解决管理挑战的食谱。

第四章，*无畏并发*，深入探讨了构建安全、快速程序的一些最佳实践和技巧。除此之外，还介绍了如 Rayon 这样的流行库，我们展示了 Rust 是一种非常适合执行各种并发任务的语言。

第五章，*处理错误和其他结果*，解释了 Rust 如何使用`Result`类型和 panic 来执行错误处理，将大多数失败案例整合到需要处理的常规工作流程中。本章展示了避免意外崩溃和不必要的复杂性的适用模式和最佳实践。

第六章，*使用宏表达自我*，解释了 Rust 独特的宏系统如何在编译前扩展程序的功能——以一种类型安全的方式。这些宏可以用于许多可能的定制场景，许多 crate 都使用了这种能力。本章全部关于创建有用的宏，使你的生活更轻松，程序更安全。

第七章，*将 Rust 与其他语言集成*，使用和 Rust 内部的不同二进制单位和语言，以便移植遗留软件或利用更好的 SDK。这主要通过**外部函数接口**（**FFI**）实现，它使得与其他原生二进制快速且容易地集成成为可能。除此之外，还可以使用 WebAssembly 从 Rust 发布到`npm`（Node.js 包仓库）。本章讨论了这些以及其他相关内容。

第八章，*Web 安全编程*，使用最先进的 Web 框架来展示 Web 编程的基础知识——`actix-web`，它展示了基于 actor 的处理请求的方法，这种方法在微软的生产环境中得到了应用。

第九章，*轻松进行系统编程*，解释了 Rust 是运行在资源有限的小型设备上的工作负载的绝佳选择。特别是，没有垃圾回收器和由此产生的可预测的运行时，使其非常适合运行传感器数据收集器。本章我们将介绍如何创建这样的循环，以及读取数据所需的驱动程序。

第十章，*用 Rust 实践*，涵盖了 Rust 编程中的实际考虑因素，例如解析命令行参数、与神经网络（使用 PyTorch 的 C++ API 进行机器学习）一起工作、搜索、正则表达式、网络请求等等。

# 为了充分利用这本书

在编程基础方面，我们考虑了一些事情，并假设你已经熟悉这些概念。以下是在编程环境中你应该能够解释的术语列表：

+   类型与枚举

+   控制语句和执行流程

+   程序架构和模式

+   流和迭代器

+   链接

+   泛型

拥有这些知识，您可以使用您选择的编辑器（我们推荐 Visual Studio Code ([`code.visualstudio.com`](https://code.visualstudio.com))，以及官方的 Rust 扩展([`marketplace.visualstudio.com/items?itemName=rust-lang.rust`](https://marketplace.visualstudio.com/items?itemName=rust-lang.rust)))开始学习。虽然 Rust 是一种跨平台编程语言，但某些菜谱在 Linux 或 macOS 上更容易实现。我们鼓励 Windows 用户使用 Windows Subsystem for Linux ([`docs.microsoft.com/en-us/windows/wsl/install-win10`](https://docs.microsoft.com/en-us/windows/wsl/install-win10))以获得更好的体验。

# 下载示例代码文件

您可以从[www.packt.com](http://www.packt.com)的账户下载本书的示例代码文件。如果您在其他地方购买了此书，您可以访问[www.packtpub.com/support](https://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在[www.packt.com](http://www.packt.com)登录或注册。

1.  选择“支持”选项卡。

1.  点击“代码下载”。

1.  在搜索框中输入书籍名称，并遵循屏幕上的说明。

下载文件后，请确保使用最新版本的软件解压缩或提取文件夹：

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

本书代码包也托管在 GitHub 上，地址为[`github.com/PacktPublishing/Rust-Programming-Cookbook`](https://github.com/PacktPublishing/Rust-Programming-Cookbook)。如果代码有更新，它将在现有的 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包可供选择，请访问[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。查看它们吧！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`static.packt-cdn.com/downloads/9781789530667_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781789530667_ColorImages.pdf)。

# 代码实战

访问以下链接查看代码运行的视频：[`bit.ly/2oMSy1J`](http://bit.ly/2oMSy1J)

# 使用的约定

本书使用了许多文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“将下载的`WebStorm-10*.dmg`磁盘映像文件作为系统中的另一个磁盘挂载。”

代码块设置如下：

```rs
macro_rules! strange_patterns {
    (The pattern must match precisely) => { "Text" };
    (42) => { "Numeric" };
    (;<=,<=;) => { "Alpha" };
}
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```rs
#[test]
#[should_panic]
fn test_failing_make_fn() {
    make_fn!(fail, {assert!(false)});
    fail();
 } 
```

任何命令行输入或输出都如下所示：

```rs
$ cargo run
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词在文本中显示如下。以下是一个示例：“从管理面板中选择系统信息。”

警告或重要提示看起来像这样。

技巧和窍门看起来像这样。

# 部分

在这本书中，您会发现几个经常出现的标题（*准备就绪*、*如何操作...*、*工作原理...*、*还有更多...* 和 *另请参阅*）。

为了清楚地说明如何完成食谱，请按照以下方式使用这些部分：

# 准备就绪

本节告诉您在食谱中可以期待什么，并描述如何设置任何软件或任何为食谱所需的初步设置。

# 如何操作…

本节包含遵循食谱所需的步骤。

# 工作原理…

本节通常包含对前一个部分发生情况的详细解释。

# 还有更多…

本节包含有关食谱的附加信息，以便您对食谱有更多的了解。

# 另请参阅

本节提供了对食谱有用的链接，以获取其他相关信息。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请在邮件主题中提及书名，并通过`customercare@packtpub.com`与我们联系。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告。请访问[www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packt.com`与我们联系，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。一旦您阅读并使用过这本书，为什么不留下您从购买网站获得的评论呢？潜在读者可以查看并使用您的客观意见来做出购买决定，Packt 公司可以了解您对我们产品的看法，我们的作者也可以看到他们对书籍的反馈。谢谢！

有关 Packt 的更多信息，请访问 [packt.com](http://www.packt.com/)。
