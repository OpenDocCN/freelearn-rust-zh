# ç¬¬å…«ç« ï¼š*ç¬¬å…«ç« *ï¼šä½¿ç”¨ wasm-pack æ‰“åŒ… WebAssembly

JavaScript æ— å¤„ä¸åœ¨ï¼Œä½†æ— å¤„ä¸åœ¨æ—¢æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ã€‚æœ‰è®¸å¤šä¸åŒçš„ç”Ÿæ€ç³»ç»Ÿï¼Œå®ƒä»¬æœ‰ä¸åŒçš„æ ‡å‡†å’Œç›®çš„ã€‚ä¸ºæ‰€æœ‰ç”Ÿæ€ç³»ç»Ÿæ„å»ºç‹¬ç‰¹çš„è§£å†³æ–¹æ¡ˆå¹¶ä¸å®é™…ã€‚

å°½ç®¡å¦‚æ­¤ï¼ŒJavaScript ç¤¾åŒºåœ¨è¿™é‡Œåšå¾—éå¸¸å‡ºè‰²ã€‚ç¤¾åŒºçš„ä»˜å‡ºä½¿ JavaScript æˆä¸ºé¦–é€‰è¯­è¨€ä¹‹ä¸€ã€‚å¯¹äºåƒ JavaScript è¿™æ ·å¤šæ‰å¤šè‰ºçš„è¯­è¨€ï¼Œæ€»ä¼šæœ‰äº›å¥‡æ€ªçš„åœ°æ–¹ï¼ˆå½“ç„¶ï¼Œæ¯ç§è¯­è¨€éƒ½æœ‰ï¼‰ã€‚å½“æ‚¨ç¼–å†™ JavaScript æ—¶ï¼Œè¿™äº›åœ°æ–¹éœ€è¦é¢å¤–çš„å…³æ³¨å’Œæ³¨æ„ã€‚

JavaScript æ˜¯åŠ¨æ€ç±»å‹çš„ã€‚è¿™ä½¿å¾—é¿å…è¿è¡Œæ—¶å¼‚å¸¸å˜å¾—å›°éš¾ï¼ˆå‡ ä¹ä¸å¯èƒ½ï¼‰ã€‚è™½ç„¶ TypeScriptã€Flow å’Œ Elm è¯•å›¾åœ¨ JavaScript çš„åŠ¨æ€ç±»å‹ä¸Šæä¾›ï¼ˆç±»å‹åŒ–çš„ï¼‰è¶…é›†ï¼Œä½†å®ƒä»¬æ— æ³•å®Œå…¨è§£å†³æ ¹æœ¬é—®é¢˜ã€‚

ä»»ä½•è¯­è¨€è¦æˆé•¿ï¼Œéƒ½å¿…é¡»å¿«é€Ÿæ¼”å˜ï¼ŒJavaScript å°±æ˜¯è¿™æ ·åšçš„ã€‚å¿«é€Ÿæ¼”å˜è€Œä¸ç ´åç°æœ‰ç”¨æ³•ä¹ŸåŒæ ·é‡è¦ï¼ŒJavaScript æä¾›äº† polyfills æ¥å®ç°å‘åå…¼å®¹ã€‚

ä½†åˆ›å»º polyfills æ˜¯ä¸€é¡¹å¹³å‡¡çš„ä»»åŠ¡ã€‚è¿˜æœ‰è®¸å¤šå…¶ä»–å¹³å‡¡çš„ä»»åŠ¡ï¼Œä¾‹å¦‚æ‰“åŒ…å’ŒåŒ…è£…åº“ã€å‹ç¼©åŒ…å’Œæ‡’åŠ è½½åº“ï¼Œä»…ä¸¾å‡ ä¾‹ã€‚æ‰“åŒ…å™¨ä¸ºå¤§å¤šæ•°è¿™äº›é—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚å®ƒä»¬å……å½“å‰ç«¯ç¼–è¯‘å™¨ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº† Rust å¦‚ä½•ä½¿åˆ›å»ºå’Œè¿è¡Œ WebAssembly æ¨¡å—å˜å¾—å®¹æ˜“ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ `wasm-pack`ï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿æ‰“åŒ…å’Œå‘å¸ƒ WebAssembly æ¨¡å—æ›´å®¹æ˜“çš„å·¥å…·ã€‚æœ¬ç« å°†æ¶µç›–ä»¥ä¸‹éƒ¨åˆ†ï¼š

+   ä½¿ç”¨ webpack æ‰“åŒ… WebAssembly æ¨¡å—

+   ä½¿ç”¨ Parcel æ‰“åŒ… WebAssembly æ¨¡å—

+   ä»‹ç» `wasm-pack`

+   ä½¿ç”¨ `wasm-pack` æ‰“åŒ…å’Œå‘å¸ƒ

# æŠ€æœ¯è¦æ±‚

æ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æœ¬ç« ä¸­å­˜åœ¨çš„ä»£ç æ–‡ä»¶ï¼Œç½‘å€ä¸º[`github.com/PacktPublishing/Practical-WebAssembly`](https://github.com/PacktPublishing/Practical-WebAssembly)ã€‚

# ä½¿ç”¨ webpack æ‰“åŒ… WebAssembly æ¨¡å—

webpack æ˜¯ç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨ã€‚é‚£ä¹ˆï¼Œå®ƒåšä»€ä¹ˆå‘¢ï¼Ÿ

æ‚¨å¯ä»¥å°† webpack è§†ä¸ºå‰ç«¯çš„ä¸€ä¸ªéæ­£å¼ç¼–è¯‘å™¨ã€‚webpack æ¥å—ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œé€æ­¥è¿è¡Œæ¨¡å—ï¼Œå¹¶æ„å»ºä¾èµ–å›¾ã€‚ä¾èµ–å›¾åŒ…å«æ‰€æœ‰æ¨¡å—ã€‚è¿™äº›æ¨¡å—å¯¹äºåº”ç”¨ç¨‹åºçš„è¿è¡Œæ˜¯å¿…è¦çš„ã€‚

ä¸€æ—¦æ„å»ºäº†ä¾èµ–å›¾ï¼Œwebpack å°±ä¼šè¾“å‡ºä¸€ä¸ªæˆ–å¤šä¸ªåŒ…ã€‚webpack éå¸¸çµæ´»ï¼Œå¸®åŠ©æˆ‘ä»¬æ ¹æ®éœ€è¦æ‰“åŒ…æˆ–åŒ…è£… JavaScriptï¼Œwebpack é…ç½®ä¸­æä¾›äº†é€‰é¡¹ã€‚æ ¹æ®æä¾›çš„é€‰é¡¹ï¼Œwebpack åˆ›å»ºè¾“å‡ºã€‚

*å¬èµ·æ¥å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ*

å‡ å¹´å‰ï¼Œå½“æˆ‘ä»¬éœ€è¦å”¯ä¸€çš„åº“å°±æ˜¯ jQuery æ—¶ï¼Œäº‹æƒ…å¾ˆç®€å•ã€‚

ä½†ç”±äº JavaScript çš„å¿«é€Ÿæ¼”å˜ï¼Œç°åœ¨æœ‰å¾ˆå¤šä¸åŒçš„äº‹æƒ…æ­£åœ¨å‘ç”Ÿã€‚åº•å±‚è¿è¡Œæ—¶ä¸å°½ç›¸åŒã€‚å­˜åœ¨ä¸‰ç§ä¸åŒçš„æµè§ˆå™¨å¼•æ“å’Œå¤šç§ç›®æ ‡ã€‚

æµè§ˆå™¨å¼•æ“çš„æ¼”è¿›é€Ÿåº¦ä¸åŒï¼Œæµè§ˆå™¨æ”¯æŒå„ç§ç‰ˆæœ¬çš„ JavaScriptã€‚åœ¨æŸäº›å·¥ä½œåœºæ‰€çš„æœºå™¨ä¸Šï¼Œå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨æ˜¯è¢«ç¦æ­¢çš„ã€‚è¿™æ„å‘³ç€è¿è¡Œçš„ JavaScript åº”ç”¨éœ€è¦åœ¨ä¸åŒçš„æ—¶é—´è¿›è¡Œè°ƒæ•´å’Œå¡«å……ã€‚

åŸºç¡€ç›®æ ‡ç³»ç»Ÿéœ€è¦å¯¹æ‚¨çš„ JavaScript ä»£ç è¿›è¡Œä¸€å®šçš„è°ƒæ•´æ‰èƒ½è¿è¡Œã€‚æ‰‹åŠ¨å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œå°†èŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”å®¹æ˜“å‡ºé”™ã€‚

JavaScript æœ‰å¤šç§å˜ä½“ï¼ŒåŒ…æ‹¬ TypeScript å’Œ CoffeeScriptã€‚å®ƒä»¬å„ä¸ç›¸åŒï¼Œä½†åœ¨è¿è¡Œä¹‹å‰éƒ½ä¼šç¼–è¯‘æˆ JavaScriptã€‚åŸºäºæµè§ˆå™¨çš„å¼€å‘éœ€è¦ CSSã€SCSSã€SASS å’Œ LESSã€‚æ”¯æŒæ‰€æœ‰è¿™äº›å˜ä½“å¹¶åœ¨æ¯æ¬¡æ›´æ”¹åæ‰‹åŠ¨ç¼–è¯‘å®ƒä»¬å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚

JavaScript å¯¹æ­¤çš„å›åº”æ˜¯æ‰“åŒ…å™¨ã€‚æ— è®ºä½ è®¨åŒå®ƒä»¬è¿˜æ˜¯å–œæ¬¢å®ƒä»¬ï¼Œæ‰“åŒ…å™¨éƒ½èƒ½åœ¨ç”¨ JavaScript å¼€å‘æ—¶å‡å°‘è´Ÿæ‹…å’Œæ··ä¹±ã€‚

webpack ä¸ºæ‰€æœ‰è¿™äº›é—®é¢˜ä»¥åŠæ›´å¤šé—®é¢˜æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚

webpack æ˜¯ä¸€ä¸ªç”¨äºæ‰“åŒ… JavaScript åº”ç”¨çš„å·¥å…·ã€‚å®ƒåŒ…å«åŠ è½½å™¨å’Œæ’ä»¶ï¼Œå¯ä»¥å¸®åŠ©è½¬æ¢ã€æ·»åŠ ã€åˆ é™¤å’Œæ“ä½œè¾“å‡ºåŒ…ã€‚webpack æœ€æœ‰è¶£çš„éƒ¨åˆ†æ˜¯å…¶åŠ è½½å™¨å’Œæ’ä»¶ï¼Œå®ƒä»¬å°† webpack çš„èƒ½åŠ›å‘æŒ¥åˆ°æè‡´ã€‚

åŠ è½½å™¨å…è®¸æˆ‘ä»¬åƒåœ¨ JavaScript ä¸­åŠ è½½æˆ–å¯¼å…¥ä»»ä½•å…¶ä»–æ¨¡å—ä¸€æ ·åŠ è½½æˆ–å¯¼å…¥ Rustã€CSS æˆ– TypeScript æ–‡ä»¶ã€‚ç„¶å webpack è´Ÿè´£ç”Ÿæˆæ”¯æŒæŒ‡å®šç›®æ ‡ç¯å¢ƒçš„åŒ…ã€‚

æ’ä»¶å…è®¸æˆ‘ä»¬ä¼˜åŒ–å’Œç®¡ç†ç”Ÿæˆçš„åŒ…ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwebpack å®Œå…¨å»ºç«‹åœ¨æ’ä»¶ç³»ç»Ÿä¹‹ä¸Šã€‚

*webpack å¦‚ä½•å¸®åŠ© WebAssemblyï¼Ÿ*

webpack å†…éƒ¨ä¾èµ–äº `webassemblyjs` åº“ã€‚å› æ­¤ï¼Œæ‰€æœ‰ä½¿ç”¨ webpack çš„åº”ç”¨éƒ½å·²ç»ä¸º WebAssembly å‡†å¤‡å°±ç»ªã€‚ä½ åªéœ€åƒåŠ è½½æ™®é€š JavaScript æ–‡ä»¶ä¸€æ ·å¼€å§‹åŠ è½½ WebAssembly æ–‡ä»¶ï¼Œwebpack å°±ä¼šå¤„ç†å…¶ä½™éƒ¨åˆ†ã€‚

åœ¨ webpack é…ç½®ä¸­ï¼Œæˆ‘ä»¬å°†å®šä¹‰å…¥å£ç‚¹ã€‚ç„¶å webpack åŠ è½½å…¥å£æ–‡ä»¶ã€‚å…¥å£æ–‡ä»¶ä¸­çš„ `import` è¯­å¥æ ¹æ® JavaScript çš„æ¨¡å—è§£æç®—æ³•è¢«åŠ è½½ä¸ºä¸€ä¸ªæ¨¡å—ã€‚å¦‚æœå¯¼å…¥çš„æ¨¡å—æ˜¯ WebAssembly æ¨¡å—ï¼Œå®ƒå°†è·å–æ¨¡å—çš„å†…å®¹å¹¶å°†å…¶äº¤ç»™ `webassemblyjs` ç¼–è¯‘å™¨ã€‚

ç¼–è¯‘å™¨è´Ÿè´£è§£æå’Œä¿®æ”¹ WebAssembly æ¨¡å—ã€‚

ä½ çŸ¥é“å—ï¼Ÿ

`webassemblyjs` å¯ä»¥ç›´æ¥è§£æ WebAssembly æ–‡æœ¬æ ¼å¼å’Œ WebAssembly äºŒè¿›åˆ¶æ ¼å¼ã€‚

ç¼–è¯‘å™¨ç”Ÿæˆ **æŠ½è±¡è¯­æ³•æ ‘**ï¼ˆ**AST**ï¼‰ã€‚ç”Ÿæˆçš„ AST ç„¶åè¿›è¡ŒéªŒè¯ã€‚ä¸€æ—¦éªŒè¯æˆåŠŸï¼ŒWebAssembly æ¨¡å—ä¸­çš„ä»»ä½•è‡ªå®šä¹‰éƒ¨åˆ†éƒ½å°†è¢«ç§»é™¤ã€‚

è‡ªå®šä¹‰éƒ¨åˆ†æ˜¯ WebAssembly æ¨¡å—å†…éƒ¨çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤å­˜å‚¨å…³äº WebAssembly æ¨¡å—çš„è‡ªå®šä¹‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯èƒ½åŒ…æ‹¬å‡½æ•°å’Œå±€éƒ¨å˜é‡çš„åç§°ã€‚æµè§ˆå™¨å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥æ”¹å–„è°ƒè¯•è¿‡ç¨‹ã€‚

webpack ä¹Ÿä¸æ”¯æŒèµ·å§‹éƒ¨åˆ†ã€‚èµ·å§‹éƒ¨åˆ†æ˜¯ WebAssembly æ¨¡å—ä¸­çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå°†åœ¨ WebAssembly æ¨¡å—åŠ è½½æ—¶ç«‹å³è°ƒç”¨ã€‚

ç›¸åï¼Œwebpack åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨ WebAssembly æ¨¡å—åŠ è½½åè°ƒç”¨å®ƒã€‚`webassemblyjs` ç§»é™¤äº†èµ·å§‹éƒ¨åˆ†ï¼Œå¹¶å°†èµ·å§‹å‡½æ•°è½¬æ¢ä¸º WebAssembly æ¨¡å—ä¸Šçš„æ™®é€šå‡½æ•°ã€‚ç„¶åï¼Œwebpack è´Ÿè´£ç”Ÿæˆè°ƒç”¨è¯¥å‡½æ•°çš„åŒ…è£…å™¨ï¼Œä»¥ä¾¿æ¨¡å—åŠ è½½åç«‹å³è°ƒç”¨ã€‚

æœ€åï¼Œ`webassemblyjs` è¿˜è´Ÿè´£ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä» WebAssembly æ¨¡å—ä¸­æ¶ˆé™¤æ­»ä»£ç ã€‚

`webassemblyjs` å†…ç½®äº†è§£é‡Šå™¨å’Œ CLIï¼Œè¿™ä½¿å¾—å®éªŒ WebAssembly æ¨¡å—å˜å¾—å®¹æ˜“ã€‚

**ä»£ç ï¼Œåˆ·æ–°ï¼Œé‡å¤ã€‚**

è¿™é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯ Web å¼€å‘çš„æµç¨‹ã€‚å®æ—¶é‡æ–°åŠ è½½ä¸º Web å¼€å‘è€…æä¾›äº†é¢å¤–çš„å¸®åŠ©ã€‚ä¸€æ—¦ä»£ç ä¿å­˜ï¼Œå®æ—¶é‡æ–°åŠ è½½å¯ä»¥è‡ªåŠ¨ç¼–è¯‘å’Œé‡æ–°åŠ è½½æ›´æ”¹ã€‚ä»£ç å¯ä»¥åœ¨å¤šä¸ªè®¾å¤‡ã€å› ç´ å’Œæ–¹å‘ä¹‹é—´å…±äº«ã€‚åœ¨ä¸€ä¸ªåœ°æ–¹è¿›è¡Œçš„äº¤äº’å¯ä»¥è‡ªåŠ¨ä¸å…¶ä»–è®¾å¤‡åŒæ­¥ã€‚è™½ç„¶ Web æä¾›äº†ä¸€ç§è½»æ¾äº¤ä»˜è½¯ä»¶çš„åª’ä»‹ï¼Œä½†å®ƒä»¥å„ç§å½¢å¼å­˜åœ¨ã€‚è¿™äº›å½¢å¼åŒ…æ‹¬åŠŸèƒ½æ‰‹æœºã€æ™ºèƒ½æ‰‹æœºã€å¹³æ¿ç”µè„‘ã€ç¬”è®°æœ¬ç”µè„‘ã€è®¡ç®—æœºã€è¶…å®½æ˜¾ç¤ºå™¨ã€360 åº¦è™šæ‹Ÿä¸–ç•Œç­‰ç­‰ã€‚æ”¯æŒæ‰€æœ‰æˆ–å…¶ä¸­ä¸€äº›æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ã€‚å®æ—¶é‡æ–°åŠ è½½å°±åƒä¸€åŒé¢å¤–çš„æ‰‹ã€‚

webpack ä¸ºæ·»åŠ å®æ—¶é‡æ–°åŠ è½½åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºæä¾›äº†å¤šä¸ªé€‰é¡¹ã€‚å®ƒä¸ºå®æ—¶é‡æ–°åŠ è½½å·¥å…·ï¼Œå¦‚ BrowserSyncï¼Œæä¾›äº†æ’ä»¶ã€‚webpack ç”Ÿæ€ç³»ç»Ÿåœ¨å…¶é…ç½®ä¸­ä¹Ÿæä¾›äº†ç›‘è§†æ¨¡å¼ã€‚

ä¸€æ—¦å¯ç”¨ï¼Œç›‘è§†æ¨¡å¼ä¼šæŸ¥æ‰¾æºæ–‡ä»¶åŠå…¶ç›®å½•ä¸­å‘ç”Ÿçš„ä»»ä½•æ›´æ”¹ã€‚ä¸€æ—¦æ£€æµ‹åˆ°æ›´æ”¹ï¼Œå®ƒå°†è‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€‚ä½†ç›‘è§†æ¨¡å¼æ˜¯ä¸ºäº†å°†è¾“å…¥é‡æ–°ç¼–è¯‘ä¸ºè¾“å‡ºã€‚

è‡ªåŠ¨é‡æ–°åŠ è½½ç½‘é¡µæ˜¯ç”±ä¸€ä¸ªåä¸º webpack-dev-server çš„åº“æä¾›çš„ã€‚webpack-dev-server æ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„ Web æœåŠ¡å™¨ã€‚å†…å®¹æ˜¯åœ¨å†…å­˜ä¸­ç”Ÿæˆå’Œæ”¾ç½®çš„ï¼Œè€Œä¸æ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å®é™…æ–‡ä»¶ä¸­ã€‚

æ­¤å¤–ï¼Œwebpack-dev-server è¿˜æ”¯æŒçƒ­æ¨¡å—æ›¿æ¢ã€‚è¿™å…è®¸æœåŠ¡å™¨ä»…ä¿®è¡¥æµè§ˆå™¨ä¸­çš„æ›´æ”¹ï¼Œè€Œä¸æ˜¯è¿›è¡Œå®Œæ•´çš„é¡µé¢åˆ·æ–°ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ WebAssembly é¡¹ç›®ä¸­å¯ç”¨å®æ—¶é‡æ–°åŠ è½½ï¼š

1.  é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ï¼š

    ```rs
    $ cargo new --lib live_reload
    Â Â Created library `live_reload` package
    ```

1.  ä¸€æ—¦åˆ›å»ºäº†é¡¹ç›®ï¼Œå°±åœ¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€å®ƒã€‚ä¸ºäº†ä¸ºé¡¹ç›®å®šä¹‰ `wasm-bindgen` ä¾èµ–é¡¹ï¼Œæ‰“å¼€ `Cargo.toml` æ–‡ä»¶ï¼š

    ```rs
    [package]
    name = "live_reload"
    version = "0.1.0"
    authors = ["Sendil Kumar"]
    edition = "2018"

    [lib]
    crate-type = ["cdylib"]

    [dependencies]
    wasm-bindgen = "0.2.38"
    ```

é¦–å…ˆï¼Œæ·»åŠ  `[lib]` éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ  `crate-type = ["cdylib"]`ã€‚é€šè¿‡ `crate-type` é€‰é¡¹ï¼Œæˆ‘ä»¬æŒ‡ç¤ºç¼–è¯‘å™¨è¯¥åº“æ˜¯åŠ¨æ€çš„ã€‚ä¹‹åï¼Œå°† `wasm-bindgen` ä¾èµ–é¡¹æ·»åŠ åˆ° `[dependencies]` æ ‡ç­¾ä¸­ã€‚

1.  ç„¶åï¼Œæ‰“å¼€ `src/lib.rs` æ–‡ä»¶ï¼Œå¹¶ç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢å…¶å†…å®¹ï¼š

    ```rs
    use wasm_bindgen::prelude::*;

    #[wasm_bindgen]
    pub fn hello_world() -> String {
    "Hello World".to_string()
    }
    ```

1.  æˆ‘ä»¬å°†åœ¨è¿™é‡Œé‡ç”¨å‰å‡ ç« ä¸­çš„ç®€å• Hello World ç¤ºä¾‹ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»º WASM æ¨¡å—ï¼š

    ```rs
    $ cargo build --target wasm32-unknown-unknown
    $ wasm-bindgen target/wasm32-unknown-
    Â Â unknown/debug/live_reload.wasm --out-dir .
    ```

1.  ç„¶ååˆ›å»ºä¸€ä¸ª`webpack.config.js`æ–‡ä»¶æ¥æŒ‡å¯¼ webpack å¦‚ä½•å¤„ç†å’Œç¼–è¯‘æ–‡ä»¶ï¼š

    ```rs
    const path = require('path');
    const HtmlWebpackPlugin = require('html-webpack-
    Â Â plugin');

    module.exports = {
    Â Â Â Â entry: './index.js',
    Â Â Â Â output: {
    Â Â Â Â Â Â Â Â path: path.resolve(__dirname, 'dist'),
    Â Â Â Â Â Â Â Â filename: 'bundle.js',
    Â Â Â Â },
    Â Â Â Â plugins: [
    Â Â Â Â Â Â Â Â new HtmlWebpackPlugin(),
    Â Â Â Â ],
    Â Â Â Â experiments: {
    Â Â Â Â Â Â Â syncWebAssembly: true,
    Â Â Â Â },
    Â Â Â Â mode: 'development'
    };
    ```

1.  æ·»åŠ ä¸€ä¸ª`package.json`æ–‡ä»¶æ¥ä¸‹è½½ webpack ä¾èµ–é¡¹ï¼š

    ```rs
    {
    Â Â Â Â "scripts": {
    Â Â Â Â Â Â Â Â "build": "webpack",
    Â Â Â Â Â Â Â Â "serve": "webpack-dev-server"
    Â Â Â Â },
    Â Â Â Â "devDependencies": {
    Â Â Â Â Â Â Â Â "html-webpack-plugin": "âµ.5.0",
    Â Â Â Â Â Â Â Â "webpack": "âµ.64.1",
    Â Â Â Â Â Â Â Â "webpack-cli": "â´.9.1",
    Â Â Â Â Â Â Â Â "webpack-dev-server": "â´.5.0"
    Â Â Â Â }
    }
    ```

    æ³¨æ„

    è¯·ä½¿ç”¨æ­¤å¤„é€‚ç”¨çš„æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–é¡¹ã€‚

1.  åˆ›å»ºä¸€ä¸ª`index.js`æ–‡ä»¶æ¥åŠ è½½ç»‘å®š JavaScriptï¼Œè¯¥ JavaScript åè¿‡æ¥åŠ è½½ç”Ÿæˆçš„ WebAssembly æ¨¡å—ï¼š

    ```rs
    import("./live_reload").then(module => {
    Â Â Â Â console.log(module.hello_world());
    });
    ```

1.  ç°åœ¨ï¼Œè½¬åˆ°ç»ˆç«¯å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… npm ä¾èµ–é¡¹ï¼š

    ```rs
    $ npm install
    ```

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œ webpack-dev-server:

```rs
$ npm run serve 
```

æˆ‘ä»¬å·²ç»ä½¿ç”¨ webpack-dev-server æ¥å¯ç”¨è‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å»æ›´æ”¹ HTMLã€CSS æˆ– JavaScript æ–‡ä»¶ã€‚ä¸€æ—¦æˆ‘ä»¬ä¿å­˜æ›´æ”¹ï¼Œwebpack æœåŠ¡å™¨å°†ç¼–è¯‘ä¸€åˆ‡ã€‚ä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œæ›´æ”¹å°†åœ¨æµè§ˆå™¨ä¸­åæ˜ å‡ºæ¥ã€‚

ä½†ç­‰ç­‰ï¼Œå¦‚æœä½ æ›´æ”¹ Rust æ–‡ä»¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬å°è¯•æ›´æ”¹å®ƒï¼š

```rs
use wasm_bindgen::prelude::*;

#[wasm_bindgen]
pub fn hello_world() -> String {
"Hello Universe".to_string()
}
```

æˆ‘ä»¬åœ¨`main.rs`æ–‡ä»¶ä¸­è¿›è¡Œäº†é‡å¤§æ›´æ”¹ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬ä»*world*æ›´æ”¹ä¸º*universe*ï¼›è¿™ä¸æ˜¯å¾ˆå¤§å—ï¼Ÿä½†ä¸€æ—¦ä½ ä¿å­˜æ–‡ä»¶ï¼Œä½ å°†ä¸ä¼šåœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°ä»»ä½•æ›´æ”¹ã€‚äº‹å®ä¸Šï¼Œç”šè‡³ webpack ç¼–è¯‘å™¨ä¹Ÿæ²¡æœ‰é‡æ–°ç¼–è¯‘ä¸œè¥¿ã€‚

webpack ç¼–è¯‘å™¨é»˜è®¤æŸ¥æ‰¾å°†åœ¨ HTMLã€CSS å’Œ JavaScript æ–‡ä»¶ä¸­å‘ç”Ÿçš„æ›´æ”¹ï¼ˆåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸œè¥¿ä»¥åŠåŒ…å«åœ¨ä¾èµ–å›¾ä¸­çš„ä¸œè¥¿ï¼‰ã€‚ä½†å®ƒå¯¹ Rust ä»£ç ä¸€æ— æ‰€çŸ¥ã€‚

æˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼å‘Šè¯‰ webpack åœ¨ Rust ä¸­æŸ¥æ‰¾ä»£ç æ›´æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ’ä»¶æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œè¯¥æ’ä»¶å°†æ£€æŸ¥æŒ‡å®šæ–‡ä»¶ç±»å‹çš„æŒ‡å®šä½ç½®ä¸­çš„ä»»ä½•æ›´æ”¹ã€‚ç„¶åï¼Œå®ƒå°†é‡æ–°è§¦å‘æ„å»ºè¿‡ç¨‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨`wasm-pack-plugin`æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†`wasm-pack-plugin`ä¾èµ–é¡¹æ·»åŠ åˆ°åº”ç”¨ç¨‹åºä¸­ï¼š

```rs
$ npm i @wasm-tool/wasm-pack-plugin -D
```

ç„¶åï¼Œé€šè¿‡`webpack.config.js`æ–‡ä»¶å°†æ­¤æ’ä»¶é’©å…¥ webpack çš„æ’ä»¶ç³»ç»Ÿï¼š

```rs
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const WasmPackPlugin = require('@wasm-tool/wasm-pack-
Â Â plugin');

module.exports = {
Â Â Â Â entry: './index.js',
Â Â Â Â output: {
Â Â Â Â Â Â Â Â path: path.resolve(__dirname, 'dist'),
Â Â Â Â Â Â Â Â filename: 'bundle.js',
Â Â Â Â },
Â Â Â Â plugins: [
Â Â Â Â Â Â Â Â new HtmlWebpackPlugin(),
Â Â Â Â Â Â Â Â new WasmPackPlugin({
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â crateDirectory: path.resolve(__dirname)
Â Â Â Â Â Â Â Â }),
Â Â Â Â ],
Â Â Â Â experiments: {
Â Â Â Â Â Â Â syncWebAssembly: true,
Â Â Â Â },
Â Â Â Â mode: 'development'
};
```

æˆ‘ä»¬å¯¼å…¥`wasm-pack-plugin`ã€‚æˆ‘ä»¬æŒ‡å®šåŒ…å«`Cargo.toml`æ–‡ä»¶çš„ crate ç›®å½•ï¼Œç„¶åæ’ä»¶å°†è´Ÿè´£è‡ªåŠ¨é‡æ–°åŠ è½½éƒ¨åˆ†ã€‚è¦çœ‹åˆ°å®ƒçš„å®é™…æ•ˆæœï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`npm run serve`åœæ­¢å¹¶å¯åŠ¨ webpack æœåŠ¡å™¨ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ Hello Galaxy ç¼–è¾‘`src/main.rs`æ–‡ä»¶ã€‚æ‰“å¼€æµè§ˆå™¨ä»¥æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—å·²æ›´æ”¹ä¸º**Hello Galaxy**ã€‚

é‚£ä¹ˆï¼Œè¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

`wasm-pack-plugin`é€šè¿‡ webpack çš„æ’ä»¶ç³»ç»Ÿè¿æ¥åˆ° webpackã€‚è¿™å°†ä¸ webpack ç¼–è¯‘å™¨ä¸€èµ·è¿è¡Œã€‚å¦‚æœ`src`ç›®å½•ä¸­å‘ç”Ÿä»»ä½•æ›´æ”¹ï¼Œ`wasm-pack-plugin`å°†è¿è¡Œ`wasm-pack`ç¼–è¯‘æ¥è‡ªåŠ¨å°† Rust ä»£ç ç¼–è¯‘æˆ WebAssembly æ¨¡å—ã€‚è¿™å°†è§¦å‘ webpack ç¼–è¯‘å™¨çš„é‡æ–°ç¼–è¯‘ã€‚ä¸€æ—¦ webpack ç¼–è¯‘å™¨é‡æ–°ç¼–è¯‘ï¼Œå®ƒå°†é€šçŸ¥`webpack-dev-server`åœ¨æµè§ˆå™¨ä¸­é‡æ–°åŠ è½½æ›´æ”¹ã€‚ç„¶åæµè§ˆå™¨å°†è‡ªåŠ¨é‡æ–°åŠ è½½æ›´æ”¹ã€‚

`wasm-pack-plugin`ä½¿å¾—åœ¨ webpack ä¸­è¿è¡Œ Rust å’Œ WebAssembly å˜å¾—å®¹æ˜“ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥å¦‚ä½•ä½¿ç”¨ Parcel è¿è¡Œ Rust å’Œ WebAssemblyã€‚

# ä½¿ç”¨ Parcel æ‰“åŒ… WebAssembly æ¨¡å—

*Parcel æ˜¯ä¸€ä¸ªå¿«é€Ÿã€é›¶é…ç½®çš„ Web åº”ç”¨ç¨‹åºæ‰“åŒ…å™¨*`index.html`)ï¼Œç„¶åä»é‚£é‡Œæ„å»ºæ•´ä¸ªå›¾ã€‚

è™½ç„¶ Webpack å…·æœ‰åŸºäºæ’ä»¶çš„æ¶æ„ï¼Œä½† Parcel å…·æœ‰åŸºäºå·¥ä½œè¿›ç¨‹çš„æ¶æ„ã€‚è¿™ä½¿å¾— Parcel æ¯” Webpack æ›´å¿«ï¼Œå› ä¸ºå®ƒä½¿ç”¨å¤šæ ¸ç¼–è¯‘å’Œç¼“å­˜ã€‚

Parcel è¿˜å†…ç½®äº†é…ç½®ä»¥æ”¯æŒ JavaScriptã€CSS å’Œ HTML æ–‡ä»¶ã€‚å°±åƒ Webpack ä¸€æ ·ï¼Œå®ƒä¹Ÿæœ‰å„ç§æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ’ä»¶æ¥é…ç½®æ‰“åŒ…å™¨ä»¥ç”Ÿæˆæ‰€éœ€çš„è¾“å‡ºã€‚

å½“éœ€è¦æ—¶ï¼Œå®ƒè¿˜å†…ç½®äº†å¯¹æ ‡å‡† Babelã€PostCSS å’Œ PostHTML çš„è½¬æ¢æ”¯æŒã€‚å¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶æ‰©å±•å’Œæ›´æ”¹å®ƒä»¬ã€‚

Parcel è¿˜å…·æœ‰è‡ªåŠ¨çš„ã€å¼€ç®±å³ç”¨çš„çƒ­æ¨¡å—æ›¿æ¢åŠŸèƒ½ï¼Œç”¨äºè·Ÿè¸ªå’Œè®°å½•æ–‡ä»¶çš„æ›´æ”¹ï¼ˆè¿™äº›æ›´æ”¹ç”±ä¾èµ–å…³ç³»å›¾è®°å½•ï¼‰ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ Parcel ä½œä¸ºæ‰“åŒ…å™¨æ¥æ„å»º WebAssembly æ¨¡å—ï¼š

1.  æˆ‘ä»¬å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ï¼š

    ```rs
    $ cargo new --lib live_reload_parcel
    Â Â Created library `live_reload_parcel` package
    ```

ä¸€æ—¦åˆ›å»ºé¡¹ç›®ï¼Œå°±åœ¨æ‚¨æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€é¡¹ç›®ã€‚

1.  è¦ä¸ºé¡¹ç›®å®šä¹‰`wasm-bindgen`ä¾èµ–é¡¹ï¼Œæ‰“å¼€`Cargo.toml`æ–‡ä»¶ï¼š

    ```rs
    [package]
    name = "live_reload_parcel"
    version = "0.1.0"
    authors = ["Sendil Kumar"]
    edition = "2018"

    [lib]
    crate-type = ["cdylib"]

    [dependencies]
    wasm-bindgen = "0.2.38"
    ```

é¦–å…ˆï¼Œåˆ é™¤`[dependencies]`æ ‡ç­¾ï¼Œå¹¶ç”¨ä¸Šé¢çš„ç²—ä½“è¡Œæ›¿æ¢å®ƒã€‚æˆ‘ä»¬æ­£åœ¨å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œç”Ÿæˆçš„åº“å°†æ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸”å®ƒä¾èµ–äº`wasm-bindgen`åº“ã€‚

1.  ç„¶åï¼Œæˆ‘ä»¬æ‰“å¼€`src/lib.rs`æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

    ```rs
    use wasm_bindgen::prelude::*;

    #[wasm_bindgen]
    pub fn hello_world() -> String {
    "Hello World".to_string()
    }
    ```

1.  æˆ‘ä»¬å°†é‡ç”¨ç®€å•çš„ Hello World ç¤ºä¾‹ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»º`wasm`æ¨¡å—ï¼š

    ```rs
    $ cargo build --target wasm32-unknown-unknown
    $ wasm-bindgen target/wasm32-unknown-
    Â Â unknown/debug/live_reload_parcel.wasm --out-dir .
    ```

1.  ç”±äº Parcel æ”¯æŒé›¶é…ç½®ï¼Œæˆ‘ä»¬æ‰€éœ€åšçš„åªæ˜¯å°† Parcel ä¾èµ–é¡¹æ·»åŠ åˆ°`package.json`ä¸­ï¼š

    ```rs
    {
    Â Â Â Â "scripts": {
    Â Â Â Â Â Â Â Â "build": "parcel index.html",
    Â Â Â Â Â Â Â Â "serve": "parcel build index.html"
    Â Â Â Â },
    Â Â Â Â "devDependencies": {
    Â Â Â Â Â Â Â Â "parcel-bundler": "Â¹.12.3"
    Â Â Â Â }
    }
    ```

ç”±äº Parcel æ˜¯é›¶é…ç½®æ‰“åŒ…å™¨ï¼Œæˆ‘ä»¬åªéœ€å®šä¹‰å®ƒçš„å…¥å£ç‚¹ã€‚æˆ‘ä»¬åœ¨`scripts`éƒ¨åˆ†å®šä¹‰å…¥å£ç‚¹ã€‚`serve`å‘½ä»¤æ˜¯æˆ‘ä»¬ç”¨äºå¼€å‘ç›®çš„è¿è¡Œä»£ç çš„å‘½ä»¤ã€‚å½“æˆ‘ä»¬å®šä¹‰`parcel build index.html`æ—¶ï¼Œæˆ‘ä»¬æ­£åœ¨é€šçŸ¥ Parcel å…¥å£ç‚¹æ˜¯`index.html`ã€‚

æ³¨æ„

è¯·ä½¿ç”¨æ­¤å¤„é€‚ç”¨çš„æœ€æ–°ç‰ˆæœ¬ã€‚

1.  ç„¶åï¼Œæˆ‘ä»¬å°†åˆ›å»ºå…¥å£ç‚¹ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª`index.html`æ–‡ä»¶ï¼Œæ­£å¦‚`package.json`è„šæœ¬ä¸­æŒ‡å®šçš„é‚£æ ·ï¼š

    ```rs
    <html>
    Â Â Â Â <head>
    Â Â Â Â Â Â Â Â ...
    Â Â Â Â Â Â Â Â <script src="img/index.js"> </script>
    Â Â Â Â </head>
    Â Â Â Â <body> ... </body>
    </html>
    ```

1.  åˆ›å»ºä¸€ä¸ª`index.js`æ–‡ä»¶æ¥åŠ è½½ç»‘å®š JavaScriptï¼Œå®ƒåè¿‡æ¥åŠ è½½ç”Ÿæˆçš„ WebAssembly æ¨¡å—ï¼š

    ```rs
    import { module } from './live_reload_parcel.js';
    module.hello_world();
    ```

1.  ç°åœ¨ï¼Œè½¬åˆ°ç»ˆç«¯ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ä¾èµ–é¡¹ï¼š

    ```rs
    $ npm install
    ```

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œ Parcel åº”ç”¨ç¨‹åºï¼š

```rs
$ npm run serve
```

Parcel çš„é›¶é…ç½®ç‰¹æ€§ä½¿å¾—å¼€å§‹ä½¿ç”¨ WebAssembly éå¸¸å®¹æ˜“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒParcel æ”¯æŒ `.wasm` æ–‡ä»¶ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥åƒå¯¼å…¥ä»»ä½•å…¶ä»– `.js` æ–‡ä»¶ä¸€æ ·å¯¼å…¥ `.wasm` æ–‡ä»¶ã€‚

é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼ŒåŒæ­¥å¯¼å…¥ WebAssembly æ¨¡å—ä»ç„¶ä¸å—æ”¯æŒã€‚ä½†æˆ‘ä»¬å¯ä»¥å°†å¯¼å…¥å†™ä¸ºåŒæ­¥å¯¼å…¥ã€‚å†…éƒ¨ï¼ŒParcel å°†ç”Ÿæˆå¿…è¦çš„é¢å¤–ä»£ç ï¼Œåœ¨ JavaScript æ‰§è¡Œå¼€å§‹å‰é¢„åŠ è½½æ–‡ä»¶ã€‚

è¿™æ„å‘³ç€ WebAssembly æ–‡ä»¶å°†æ˜¯ä¸€ä¸ªå•ç‹¬çš„åŒ…ï¼Œè€Œä¸æ˜¯ä¸æ‰“åŒ…çš„ JavaScript æ–‡ä»¶ä¸€èµ·ã€‚

1.  è®©æˆ‘ä»¬æ›´æ”¹ Rust æ–‡ä»¶å¹¶çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

    ```rs
     use wasm_bindgen::prelude::*;

    #[wasm_bindgen]
    pub fn hello_world() -> String {
    "Hello Universe".to_string()
    }
    ```

1.  ä¿å­˜æ–‡ä»¶åï¼Œæ‚¨å°†çœ‹ä¸åˆ°ä»»ä½•å˜åŒ–ã€‚Parcel æ— æ³•å¾—çŸ¥æ‚¨å·²æ›´æ”¹æºä»£ç ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šåšå‡ºååº”ã€‚

è¦ä½¿ Parcel å¯¹ Rust æºä»£ç æ›´æ”¹åšå‡ºååº”ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªæ’ä»¶ã€‚è¯¥æ’ä»¶æ˜¯ `parcel-plugin-wasm.rs`ã€‚

1.  è¦å®‰è£…æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

    ```rs
    npm install -D parcel-plugin-wasm.rs
    ```

è¿™å°†æŠŠæ’ä»¶ä¸‹è½½åˆ° `node_modules`ã€‚è¿™ä¹Ÿä¼šåœ¨ `package.json` çš„ `devDependencies` ä¸­ä¿å­˜æ’ä»¶ã€‚

1.  å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦æ›´æ”¹ `index.js`ï¼Œä½¿å…¶ç›´æ¥æŸ¥çœ‹æºä»£ç ï¼Œè€Œä¸æ˜¯ä» `Cargo.toml` æ–‡ä»¶ä¸­å¼•ç”¨ï¼š

    ```rs
    import { hello_world } from './src/lib.rs';
    // import { hello_world } from './Cargo.toml'; 
    hello_world();
    ```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸æ˜¯ä» WebAssembly æ¨¡å—å¯¼å…¥ï¼Œè€Œæ˜¯æŒ‡å®šå…¥å£ Rust æ–‡ä»¶ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥æŒ‡å®š `Cargo.toml` æ–‡ä»¶çš„ä½ç½®ï¼Œä»¥ä¾¿ Parcel åœ¨ç›¸åº”ä½ç½®æŸ¥æ‰¾æ›´æ”¹ã€‚

1.  ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ Hello Galaxy ç¼–è¾‘ `src/main.rs` æ–‡ä»¶ã€‚æ‰“å¼€æµè§ˆå™¨æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—å¦‚ä½•å˜ä¸º **Hello Galaxy**ã€‚

é‚£ä¹ˆï¼Œè¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

Parcel åªéœ€è¦æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„èµ·ç‚¹ã€‚å®ƒå°†ä»é‚£é‡Œç”Ÿæˆä¾èµ–å›¾ã€‚Parcel æ’ä»¶ä¼šæŒç»­æŸ¥æ‰¾æ–‡ä»¶å¤¹ä¸­çš„ä»»ä½•æ›´æ”¹ã€‚å®ƒåŸºæœ¬ä¸Šä¼šæŸ¥çœ‹åŒ…å« `Cargo.toml` æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚`Cargo.toml` çš„ä½ç½®æ˜¯é€šè¿‡ `index.js` ä¼ é€’ç»™ Parcel æ‰“åŒ…å™¨å’Œå…¶æ’ä»¶çš„ã€‚

å› æ­¤ï¼Œå¯¹ Rust æ–‡ä»¶æ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½å°†å¯¼è‡´ä»¥ä¸‹è¿‡ç¨‹ã€‚

å½“ Rust æ–‡ä»¶è¢«ä¿å­˜æ—¶ï¼Œ`parcel-plugin-wasm.rs` å†…éƒ¨çš„ç›‘è§†å™¨ä¼šè¢«è§¦å‘ã€‚ç„¶åï¼Œ`parcel-plugin-wasm.rs` å°†é€šè¿‡ `wasm-pack` å¯åŠ¨ Rust ä»£ç ç¼–è¯‘æˆ WebAssembly çš„è¿‡ç¨‹ã€‚ä¸€æ—¦ `wasm-pack` ç¼–è¯‘å¹¶ç”Ÿæˆæ–°çš„ WebAssembly ä»£ç ï¼Œæ’ä»¶å°†é€šçŸ¥ Parcel ç¼–è¯‘å™¨ä¾èµ–å›¾ä¸­çš„æŸä¸ªéƒ¨åˆ†å‘ç”Ÿäº†å˜åŒ–ã€‚

ç„¶åï¼ŒParcel ç¼–è¯‘å™¨ä¼šé‡æ–°ç¼–è¯‘ï¼Œè¿™å°†å¯¼è‡´æµè§ˆå™¨åˆ·æ–°ã€‚æµè§ˆå™¨ç°åœ¨æ˜¾ç¤ºæ›´æ”¹åçš„æ¶ˆæ¯ã€‚

æ³¨æ„ï¼Œå¯¹äº Parcelï¼Œæˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨äº†åŒæ­¥æ¨¡å—å¯¼å…¥ï¼Œè€Œå¯¹äº webpackï¼Œæˆ‘ä»¬ä¾èµ–äºå¼‚æ­¥å¯¼å…¥ã€‚

`parcel-plugin-wasm.rs` æ’ä»¶ä½¿å¾—åœ¨ Parcel ä¸­è¿è¡Œ Rust å’Œ WebAssembly å˜å¾—å®¹æ˜“ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ `wasm-pack` æ¥æ‰“åŒ…å’Œå‘å¸ƒ WebAssembly æ¨¡å—ã€‚

# ä»‹ç» wasm-pack

ä¸ºäº†ä¸ JavaScript å…¼å®¹ï¼ŒåŸºäº Rust çš„ WebAssembly åº”ç”¨ç¨‹åºåº”è¯¥èƒ½å¤Ÿå®Œå…¨ä¸ JavaScript ä¸–ç•Œäº’æ“ä½œã€‚æ²¡æœ‰è¿™ä¸€ç‚¹ï¼Œå¼€å‘è€…å°†éš¾ä»¥åœ¨ JavaScript ä¸­å¯åŠ¨ä»–ä»¬çš„ WebAssembly é¡¹ç›®ã€‚

èŠ‚ç‚¹æ¨¡å—å®Œå…¨æ”¹å˜äº† JavaScript ä¸–ç•Œçš„è§†è§’ã€‚å®ƒä»¬ä½¿å¾—åœ¨æµè§ˆå™¨å’Œ Node ç¯å¢ƒä¹‹é—´å¼€å‘å’Œå…±äº«æ¨¡å—å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¸–ç•Œå„åœ°çš„å¼€å‘è€…å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å’Œä»»ä½•æ—¶å€™ä½¿ç”¨è¿™äº›åº“ã€‚

`wasm-pack` å·¥å…·æ—¨åœ¨æˆä¸ºæ„å»ºå’Œä¸ Rust ç”Ÿæˆçš„ WebAssembly äº¤äº’çš„ä¸€ç«™å¼å•†åº—ï¼Œè¿™äº› WebAssembly å¯ä»¥åœ¨æµè§ˆå™¨æˆ– Node.js ä¸­ä¸ JavaScript äº¤äº’ã€‚`- wasm-pack` ç½‘ç«™ã€‚[`github.com/rustwasm/wasm-pack`](https://github.com/rustwasm/wasm-pack)

## ä½ ä¸ºä»€ä¹ˆéœ€è¦ wasm-packï¼Ÿ

`wasm-pack` ä½¿å¾—æ„å»ºå’Œæ‰“åŒ…åŸºäº Rust å’Œ WebAssembly çš„é¡¹ç›®å˜å¾—ç®€å•ã€‚ä¸€æ—¦æ‰“åŒ…ï¼Œæ¨¡å—å°±å‡†å¤‡å¥½é€šè¿‡ npm æ³¨å†Œè¡¨ä¸ä¸–ç•Œå…±äº«â€”â€”å°±åƒé‚£é‡Œæ•°ç™¾ä¸‡ï¼ˆç”šè‡³æ•°åäº¿ï¼‰çš„ JavaScript åº“ä¸€æ ·ã€‚

## å¦‚ä½•ä½¿ç”¨ wasm-pack

`wasm-pack` å¯ä½œä¸º Cargo åº“ä½¿ç”¨ã€‚å¦‚æœæ‚¨æ­£åœ¨è·Ÿéšè¿™æœ¬ä¹¦å­¦ä¹ ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½å·²ç»å®‰è£…äº† Cargoã€‚è¦å®‰è£… `wasm-pack`ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```rs
$ cargo install wasm-pack
```

ä¸Šè¿°å‘½ä»¤å°†ä¸‹è½½ã€ç¼–è¯‘å¹¶å®‰è£… `wasm-pack` åº“ã€‚ä¸€æ—¦å®‰è£…å®Œæˆï¼Œ`wasm-pack` å‘½ä»¤å°†å¯ç”¨ã€‚

è¦æ£€æŸ¥ `wasm-pack` æ˜¯å¦æ­£ç¡®å®‰è£…ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```rs
$ wasm-pack --version
wasm-pack 0.6.0
```

ä¸€æ—¦æ‚¨å®‰è£…äº† `wasm-pack`ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ `wasm-pack` æ¥æ„å»ºå’Œæ‰“åŒ… Rust å’Œ WebAssembly é¡¹ç›®ï¼š

1.  æˆ‘ä»¬å°†é¦–å…ˆä½¿ç”¨ Cargo ç”Ÿæˆä¸€ä¸ªæ–°çš„é¡¹ç›®ã€‚è¦ç”Ÿæˆé¡¹ç›®ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

    ```rs
    $ cargo new --lib wasm_pack_world
    Â Â Created library `wasm_pack_world` package
    ```

ä¸€æ—¦é¡¹ç›®åˆ›å»ºå®Œæˆï¼Œè¯·ä½¿ç”¨æ‚¨æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€å®ƒã€‚

1.  è¦ä¸ºé¡¹ç›®å®šä¹‰ `wasm-bindgen` ä¾èµ–é¡¹ï¼Œè¯·æ‰“å¼€ `cargo.toml` æ–‡ä»¶ï¼š

    ```rs
    [package]
    name = "wasm_pack_world"
    version = "0.1.0"
    authors = ["Sendil Kumar"]
    edition = "2018"

    [lib]
    crate-type = ["cdylib"]

    [dependencies]
    wasm-bindgen = "0.2.38"
    ```

é¦–å…ˆï¼Œåˆ é™¤ `[dependencies]` æ ‡ç­¾ï¼Œå¹¶ç”¨ `wasm-bindgen` åº“æ›¿æ¢å®ƒã€‚æˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ­£åœ¨ç”Ÿæˆçš„åº“å°†æ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸”å®ƒä¾èµ–äº `wasm-bindgen` åº“ã€‚

1.  ç„¶åï¼Œæˆ‘ä»¬æ‰“å¼€ `src/lib.rs` æ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

    ```rs
    use wasm_bindgen::prelude::*;

    #[wasm_bindgen]
    pub fn get_me_universe_answer() -> i32 {
    Â Â Â Â 42
    }
    ```

å†æ¬¡å¼ºè°ƒï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°å­—ï¼ˆè¿™æ˜¯ä¸‡èƒ½çš„ç­”æ¡ˆï¼‰ã€‚

ä»¥å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ `rustc` æˆ– Cargo æ„å»º Rust å’Œ WebAssembly åº”ç”¨ç¨‹åºã€‚è¿™ä¼šäº§ç”Ÿä¸€ä¸ª WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½†äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«å¹¶æ²¡æœ‰ç”¨ï¼›å®ƒéœ€è¦ä¸€ä¸ªç»‘å®šæ–‡ä»¶ã€‚ä½¿ç”¨ `wasm-bindgen`ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆç»‘å®šæ–‡ä»¶ä»¥åŠ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

è¿™ä¸¤ä¸ªæ­¥éª¤æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä½†å®ƒä»¬å¾ˆå¹³å‡¡ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ `wasm-pack` æ›¿æ¢å®ƒä»¬ã€‚

1.  è¦ä½¿ç”¨ `wasm-pack` æ„å»º WebAssembly åº”ç”¨ç¨‹åºï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

    ```rs
    $ wasm-pack build
    ```

å½“æˆ‘ä»¬è¿è¡Œ `wasm-pack build` æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š

1.  `wasm-pack` é¦–å…ˆæ£€æŸ¥ Rust ç¼–è¯‘å™¨æ˜¯å¦å·²å®‰è£…ã€‚å¦‚æœå·²å®‰è£…ï¼Œé‚£ä¹ˆå®ƒä¼šæ£€æŸ¥ Rust ç¼–è¯‘å™¨ç‰ˆæœ¬æ˜¯å¦å¤§äº 1.30ã€‚

1.  `wasm-pack` æ£€æŸ¥ crate é…ç½®ä»¥åŠåº“æ˜¯å¦æŒ‡ç¤ºæˆ‘ä»¬æ­£åœ¨ç”ŸæˆåŠ¨æ€åº“ã€‚

1.  `wasm-pack` éªŒè¯æ˜¯å¦æœ‰ä»»ä½• `wasm-target` å¯ç”¨äºæ„å»ºã€‚å¦‚æœ `wasm32-unknown-unknown` ç›®æ ‡ä¸å¯ç”¨ï¼Œ`wasm-pack` å°†ä¸‹è½½å¹¶æ·»åŠ è¯¥ç›®æ ‡ã€‚

1.  ä¸€æ—¦ç¯å¢ƒå‡†å¤‡å°±ç»ªï¼Œ`wasm-pack` ç„¶åå¼€å§‹ç¼–è¯‘æ¨¡å—å¹¶æ„å»º WebAssembly æ¨¡å—å’Œç»‘å®š JavaScript æ–‡ä»¶ã€‚

æ³¨æ„ï¼Œ`wasm-pack` å‘½ä»¤ä¹Ÿä¼šç”Ÿæˆ `package.json` æ–‡ä»¶ã€‚`package.json` æ–‡ä»¶çœ‹èµ·æ¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š

```rs
{
"name": "wasm_pack_world",
"collaborators": [
"Sendil Kumar"
],
"version": "0.1.0",
"files": [
Â Â Â Â Â "wasm_pack_world_bg.wasm",
Â Â Â Â Â "wasm_pack_world.js",
Â Â Â Â Â "wasm_pack_world.d.ts"
],
"module": "wasm_pack_world.js",
"types": "wasm_pack_world.d.ts",
"sideEffects": "false"
}
```

1.  æœ€åï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå®ƒä¼šå¤åˆ¶ Readme å’Œ LICENSE æ–‡ä»¶ï¼Œä»¥ç¡®ä¿ Rust å’Œ WebAssembly ç‰ˆæœ¬ä¹‹é—´æœ‰å…±äº«æ–‡æ¡£ã€‚

`wasm-pack` è¿˜ä¼šæ£€æŸ¥ `wasm-bindgen-cli` çš„å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå°†ä½¿ç”¨ Cargo è¿›è¡Œå®‰è£…ã€‚

1.  å½“æ„å»ºæˆåŠŸå®Œæˆåï¼Œå®ƒå°†åˆ›å»ºä¸€ä¸ª `pkg` ç›®å½•ã€‚åœ¨ `pkg` ç›®å½•å†…ï¼Œå®ƒå°†é€šè¿‡ `wasm-bindgen` å°†è¾“å‡ºé‡å®šå‘ï¼š

    ```rs
    pkg
    â”œâ”€â”€ package.json
    â”œâ”€â”€ wasm_pack_world.d.ts
    â”œâ”€â”€ wasm_pack_world.js
    â”œâ”€â”€ wasm_pack_world_bg.d.ts
    â””â”€â”€ wasm_pack_world_bg.wasm
    ```

ç°åœ¨ï¼Œè¿™ä¸ª `pkg` æ–‡ä»¶å¤¹å¯ä»¥åƒä»»ä½•å…¶ä»– JavaScript æ¨¡å—ä¸€æ ·æ‰“åŒ…å’Œå…±äº«ã€‚æˆ‘ä»¬å°†åœ¨æœªæ¥çš„èœè°±ä¸­çœ‹åˆ°å¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‚

`wasm-pack` æ˜¯ä¸€ä¸ªæ‰“åŒ…å’Œå‘å¸ƒ WebAssembly æ¨¡å—çš„å¼ºå¤§å·¥å…·ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚

# ä½¿ç”¨ wasm-pack æ‰“åŒ…å’Œå‘å¸ƒ

å¯¹äºåº“å¼€å‘è€…æ¥è¯´ï¼Œæœ€ä»¤äººæƒŠå¹ï¼ˆå½“ç„¶ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼‰çš„äº‹æƒ…å°±æ˜¯æ‰“åŒ…å’Œå‘å¸ƒå·¥ä»¶ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ—¥å¤œç²¾å¿ƒåˆ¶ä½œåº”ç”¨ç¨‹åºï¼Œå°†å…¶å‘å¸ƒåˆ°ä¸–ç•Œï¼Œæ¥æ”¶åé¦ˆï¼ˆæ— è®ºæ˜¯è´Ÿé¢è¿˜æ˜¯æ­£é¢ï¼‰ï¼Œç„¶åæ ¹æ®è¿™äº›åé¦ˆå¢å¼ºåº”ç”¨ç¨‹åºçš„åŸå› ã€‚

ä»»ä½•é¡¹ç›®çš„å…³é”®ç‚¹æ˜¯å…¶é¦–æ¬¡å‘å¸ƒï¼Œè¿™å†³å®šäº†é¡¹ç›®çš„å‘½è¿ã€‚å³ä½¿å®ƒåªæ˜¯ä¸€ä¸ª MVPï¼Œå®ƒä¹Ÿä¼šè®©ä¸–ç•Œä¸€ç¥æˆ‘ä»¬æ­£åœ¨åšä»€ä¹ˆï¼Œå¹¶è®©æˆ‘ä»¬ä¸€ç¥æœªæ¥æˆ‘ä»¬å¿…é¡»åšä»€ä¹ˆã€‚

`wasm-pack` å¸®åŠ©æˆ‘ä»¬å°†åŸºäº Rust å’Œ WebAssembly çš„é¡¹ç›®æ„å»ºã€æ‰“åŒ…å’Œå‘å¸ƒåˆ° npm æ³¨å†Œè¡¨ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† `wasm-pack` å¦‚ä½•é€šè¿‡åº•å±‚çš„ `wasm-bindgen` ä½¿å°† Rust æ„å»ºåˆ° WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ä»¥åŠç»‘å®š JavaScript æ–‡ä»¶å˜å¾—æ›´åŠ ç®€å•ã€‚è®©æˆ‘ä»¬è¿›ä¸€æ­¥æ¢ç´¢æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ `pack` å’Œ `publish` æ ‡å¿—åšä»€ä¹ˆã€‚

`wasm-pack` æä¾›äº†ä¸€ä¸ª `pack` æ ‡å¿—æ¥æ‰“åŒ…ä½¿ç”¨ `wasm-pack` æ„å»ºå‘½ä»¤ç”Ÿæˆçš„å·¥ä»¶ã€‚å°½ç®¡ä½¿ç”¨ `wasm-pack` æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†å®ƒç”Ÿæˆäº†æˆ‘ä»¬å°†éœ€è¦å°†å·¥ä»¶æ‰“åŒ…æˆ Node æ¨¡å—çš„æ‰€æœ‰æ ·æ¿ä»£ç ã€‚

ä¸ºäº†ä½¿ç”¨ `wasm-pack` æ‰“åŒ…æ„å»ºçš„å·¥ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶å‚è€ƒ `pkg`ï¼ˆæˆ–æˆ‘ä»¬ç”Ÿæˆæ„å»ºå·¥ä»¶çš„é‚£ä¸ªç›®å½•ï¼‰ï¼š

```rs
$ wasm-pack pack pkg
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¼ é€’ `project_folder/pkg` ä½œä¸ºå…¶å‚æ•°æ¥è¿è¡Œå‘½ä»¤ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œ`wasm-pack pack` å‘½ä»¤å°†åœ¨å®ƒè¿è¡Œçš„å½“å‰å·¥ä½œç›®å½•ä¸­æœç´¢ `pkg` ç›®å½•ã€‚

`wasm-pack pack` å‘½ä»¤é¦–å…ˆç¡®å®šæä¾›çš„æ–‡ä»¶å¤¹æ˜¯å¦æ˜¯ `pkg` ç›®å½•æˆ–åŒ…å«ä¸€ä¸ª `pkg` ç›®å½•ä½œä¸ºå…¶ç›´æ¥å­ç›®å½•ã€‚å¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œé‚£ä¹ˆ `wasm-pack` å°†è°ƒç”¨åº•å±‚çš„ npm pack å‘½ä»¤ï¼Œå°†åº“æ‰“åŒ…æˆä¸€ä¸ª npm åŒ…ã€‚

ä¸ºäº†æ†ç»‘ npm åŒ…ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„ `package.json` æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ç”± `wasm-pack` æ„å»ºå‘½ä»¤ç”Ÿæˆã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ä¹‹å‰çš„èœè°±ä¸­çš„ `cg-array-world` ç¤ºä¾‹å†…éƒ¨è¿è¡Œ `pack` å‘½ä»¤ï¼Œå¹¶æ£€æŸ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

```rs
$ wasm-pack pack
npm notice
npm notice ğŸ“¦ cg-array-world@0.1.0
npm notice === Tarball Contents ===
npm notice 313B package.json
npm notice 32.7kB cg_array_world_bg.wasm
npm notice 135B cg_array_world.d.ts
npm notice 1.6kB cg_array_world.js
npm notice 1.5kB README.md
npm notice === Tarball Details ===
npm notice name: cg-array-world
npm notice version: 0.1.0
npm notice filename: cg-array-world-0.1.0.tgz
npm notice package size: 16.0 kB
npm notice unpacked size: 36.4 kB
npm notice shasum: 243488f1f5a859b60bb34f39146b35ba720dd8ea
npm notice integrity: sha512-9SFuObzEpi254[...]/lkHq6RKSgnNw==
npm notice total files: 5
npm notice
cg-array-world-0.1.0.tgz
| ğŸ’ packed up your package!
```

æ­£å¦‚ä½ æ‰€è§ï¼Œ`pack` å‘½ä»¤åœ¨ `npm pack` å‘½ä»¤çš„å¸®åŠ©ä¸‹ï¼Œåˆ›å»ºäº†ä¸€ä¸ªåŒ…å« `pkg` æ–‡ä»¶å¤¹å†…å®¹çš„ tarball åŒ…ã€‚

ä¸€æ—¦æˆ‘ä»¬æ‰“åŒ…äº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œä¸‹ä¸€æ­¥æ˜¾ç„¶å°±æ˜¯å‘å¸ƒå®ƒã€‚ä¸ºäº†å‘å¸ƒç”Ÿæˆçš„ tarballï¼Œ`wasm-pack` æœ‰ä¸€ä¸ª `publish` é€‰é¡¹ã€‚

ä¸ºäº†å‘å¸ƒåŒ…ï¼Œæˆ‘ä»¬å¿…é¡»è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```rs
$ wasm-pack publish
```

`wasm-pack publish`å‘½ä»¤å°†é¦–å…ˆæ£€æŸ¥æä¾›çš„ç›®å½•ä¸­æ˜¯å¦å·²ç»å­˜åœ¨`pkg`ç›®å½•ã€‚

å¦‚æœ`pkg`ç›®å½•ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå®ƒä¼šè¯¢é—®ä½ æ˜¯å¦æƒ³è¦é¦–å…ˆåˆ›å»ºåŒ…ï¼š

```rs
$ wasm-pack publish
Your package hasn't been built, build it? [Y/n]
```

å¦‚æœä½ å›ç­”`Y`æ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆå®ƒä¼šè¦æ±‚ä½ è¾“å…¥ä½ æƒ³è¦ç”Ÿæˆæ„å»ºå·¥ä»¶æ–‡ä»¶å¤¹çš„ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥ç»™å‡ºä»»ä½•æ–‡ä»¶å¤¹åç§°æˆ–ä½¿ç”¨é»˜è®¤å€¼ï¼š

```rs
$ wasm-pack publish
Your package hasn't been built, build it? yes
out_dir[default: pkg]:
```

ç„¶åï¼Œå®ƒä¼šè¯¢é—®ä½ çš„ç›®æ ‡ï¼Œå³æ„å»ºåº”è¯¥ç”Ÿæˆçš„ç›®æ ‡ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé€‰æ‹©å„ç§é€‰é¡¹ï¼Œå¦‚æ„å»ºé…æ–¹ä¸­æ‰€è¿°ï¼š

```rs
$ wasm-pack publish
Your package hasn't been built, build it? yes
out_dir[default: pkg]: .
target[default: browser]:
> browser
nodejs
no-modules
```

æ ¹æ®æä¾›çš„é€‰é¡¹ï¼Œå®ƒå°†åœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆå·¥ä»¶ã€‚

ä¸€æ—¦ç”Ÿæˆå·¥ä»¶ï¼Œå®ƒä»¬å°±å‡†å¤‡å¥½ä½¿ç”¨ npm publish è¿›è¡Œå‘å¸ƒäº†ã€‚ä¸ºäº† npm publish èƒ½å¤Ÿæ­£ç¡®å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè®¤è¯ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ npm login æˆ–`wasm-pack` login æ¥å¯¹ npm è¿›è¡Œè®¤è¯ã€‚

`wasm-pack login`å‘½ä»¤å°†è°ƒç”¨åº•å±‚çš„ npm login å‘½ä»¤ç„¶ååˆ›å»ºä¸€ä¸ªä¼šè¯ï¼š

```rs
$ wasm-pack login
Username: sendilkumarn
Password: *************
login succeeded.
```

`wasm-pack publish`å‘½ä»¤è¿˜æ”¯æŒä¸¤ä¸ªé€‰é¡¹ï¼Œå³ä»¥ä¸‹å†…å®¹ï¼š

+   `-a`æˆ–`--access`ç”¨äºç¡®å®šè¦éƒ¨ç½²çš„åŒ…çš„è®¿é—®çº§åˆ«ã€‚

è¿™æ¥å—`public`æˆ–`restricted`ï¼š

+   `public` â€“ ä½¿åŒ…å…¬å¼€

+   `restricted` â€“ ä½¿åŒ…å†…éƒ¨åŒ–

+   `-t`æˆ–`--target`ç”¨äºæ”¯æŒåœ¨æ„å»ºä¸­äº§ç”Ÿçš„å„ç§ç›®æ ‡ã€‚

å› æ­¤ï¼Œ`wasm-pack`ä½¿å¾—æ‰“åŒ…å’Œå‘å¸ƒ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶å˜å¾—ç®€å•ã€‚

# æ‘˜è¦

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ webpack å’Œ Parcel ç­‰æ‰“åŒ…å™¨è¿è¡Œ WebAssembly é¡¹ç›®ã€‚Parcel å’Œ webpack ä½¿å¾— JavaScript å¼€å‘è€…èƒ½å¤Ÿè½»æ¾è¿è¡Œå’Œå¼€å‘ Rust å’Œ WebAssembly é¡¹ç›®ã€‚ç„¶åï¼Œæˆ‘ä»¬å®‰è£…äº†`wasm-pack`å¹¶ä½¿ç”¨å®ƒæ¥è¿è¡Œé¡¹ç›®ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`wasm-pack`å°† WebAssembly æ¨¡å—æ‰“åŒ…å¹¶å‘å¸ƒåˆ° npmã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨`wasm-bindgen`åœ¨ Rust å’Œ WebAssembly ä¹‹é—´å…±äº«å¤æ‚å¯¹è±¡ã€‚
